function saveSearch(a){var b=prompt("Name this search","my search");if(null!==b){var c=encodeURIComponent(b),d=encodeURI(a);jQuery.getJSON("/component/functions.cfc",{method:"saveSearch",returnURL:d,srchName:c,returnformat:"json",queryformat:"column"},function(a){"success"!=a&&alert(a)})}}function insertTypes(a){var b=document.createElement("DIV");b.id="ajaxStatus",b.className="ajaxStatus",b.innerHTML="Checking for Types...",document.body.appendChild(b),jQuery.getJSON("/component/functions.cfc",{method:"getTypes",idList:a,returnformat:"json",queryformat:"column"},function(a){var b=document.getElementById("ajaxStatus");try{for(b.innerHTML="Processing Types....",i=0;i<a.ROWCOUNT;++i){var c=a.DATA.COLLECTION_OBJECT_ID[i],d=a.DATA.TYPELIST[i],e="CatItem_"+c;if(e.length>0){var f=document.getElementById(e),g='<div class="showType">'+d+"</div>";f.innerHTML+=g}}}catch(a){}document.body.removeChild(b)})}function insertMedia(a){var b=document.createElement("DIV");b.id="ajaxStatus",b.className="ajaxStatus",b.innerHTML="Checking for Media...",document.body.appendChild(b),jQuery.getJSON("/component/functions.cfc",{method:"getMedia",idList:a,returnformat:"json",queryformat:"column"},function(a){try{var b=document.getElementById("ajaxStatus");for(b.innerHTML="Processing Media....",i=0;i<a.ROWCOUNT;++i){var c,d=a.DATA.COLLECTION_OBJECT_ID[i],e=a.DATA.MEDIA_ID[i],f=a.DATA.MEDIA_RELATIONSHIP[i];if("cataloged_item"==f?c="CatItem_"+d:"collecting_event"==f&&(c="SpecLocality_"+d),c.length>0){var g=document.getElementById(c),h='<a href="/MediaSearch.cfm?action=search&media_id='+e+'" class="mediaLink" target="_blank" id="mediaSpan_'+d+'">';h+="Media",h+="</a>",g.innerHTML+=h}}document.body.removeChild(b)}catch(a){b=document.getElementById("ajaxStatus"),document.body.removeChild(b)}})}function addPartToLoan(a){var b="item_remark_"+a,c="item_instructions_"+a,d="subsample_"+a,e=document.getElementById(b).value,f=document.getElementById(c).value,g=document.getElementById(d).checked;g=1==g?1:0;var h=document.getElementById("transaction_id").value;jQuery.getJSON("/component/functions.cfc",{method:"addPartToLoan",transaction_id:h,partID:a,remark:e,instructions:f,subsample:g,returnformat:"json",queryformat:"column"},function(a){var b=a.split("|"),c=b[0];if(1==c){var d="theButton_"+b[1],e=document.getElementById(d);e.value="In Loan",e.onclick=""}else{var f=b[1];alert("An error occured!\n"+f)}})}function success_makePartThingy(a){result=a.DATA;var b,c;for(i=0;i<a.ROWCOUNT;++i){var d="partCell_"+result.COLLECTION_OBJECT_ID[i];if(document.getElementById(d)){var e=document.getElementById(d);e.innerHTML="Fetching loan data....",b==result.COLLECTION_OBJECT_ID[i]?c+="<tr>":c='<table border width="100%"><tr>',c+='<td nowrap="nowrap" class="specResultPartCell">',c+="<i>"+result.PART_NAME[i],result.SAMPLED_FROM_OBJ_ID[i]>0&&(c+="&nbsp;sample"),c+="("+result.PRESERVE_METHOD[i]+")",c+="["+result.LOT_COUNT[i]+"]",c+="&nbsp;("+result.COLL_OBJ_DISPOSITION[i]+")</i> ["+result.BARCODE[i]+"]",c+='</td><td nowrap="nowrap" class="specResultPartCell">',c+='Remark:&nbsp;<input type="text" name="item_remark" size="10" id="item_remark_'+result.PARTID[i]+'">',c+='</td><td nowrap="nowrap" class="specResultPartCell">',c+='Instr.:&nbsp;<input type="text" name="item_instructions" size="10" id="item_instructions_'+result.PARTID[i]+'">',c+='</td><td nowrap="nowrap" class="specResultPartCell">',c+='Subsample?:&nbsp;<input type="checkbox" name="subsample" id="subsample_'+result.PARTID[i]+'">',c+='</td><td nowrap="nowrap" class="specResultPartCell">',c+='<input type="button" id="theButton_'+result.PARTID[i]+'"',c+=' class="insBtn"',result.TRANSACTION_ID[i]>0?c+=' onclick="" value="In Loan">':(c+=' value="Add" onclick="addPartToLoan(',c+=result.PARTID[i]+');">'),null!==result.ENCUMBRANCE_ACTION[i]&&(c+="<br><i>Encumbrances:&nbsp;"+result.ENCUMBRANCE_ACTION[i]+"</i>"),c+="</td>",result.COLLECTION_OBJECT_ID[i+1]&&result.COLLECTION_OBJECT_ID[i+1]==result.COLLECTION_OBJECT_ID[i]?c+="</tr>":(c+="</tr></table>",e.innerHTML=c),b=result.COLLECTION_OBJECT_ID[i]}}}function makePartThingy(){var a=document.getElementById("transaction_id").value;jQuery.getJSON("/component/functions.cfc",{method:"getLoanPartResults",transaction_id:a,returnformat:"json",queryformat:"column"},success_makePartThingy)}function cordFormat(a){var b;if(null==a)b="";else{b=a;var c=/s/gi;b=b.replace(c,"''"),c=/d/gi,b=b.replace(c,"<sup>o</sup>"),c=/m/gi,b=b.replace(c,"'"),c=/ /gi,b=b.replace(c,"&nbsp;")}return b}function spaceStripper(a){a=String(a);var b;return b=null==a?"":a.replace(/ /gi,"&nbsp;")}function splitByComma(a){var b;if(null==a)b="";else{var c=/, /gi;b=a.replace(c,"<br>"),c=/ /gi,b=b.replace(c,"&nbsp;")}return b}function splitByLF(a){var b;return b=null==a?"":a.replace("\n","<br>","g")}function splitBySemicolon(a){var b;if(null==a)b="";else{var c=/; /gi;b=a.replace(c,"<br>"),c=/ /gi,b=b.replace(c,"&nbsp;")}return b}function goPickParts(a,b){var c="/picks/internalAddLoanItemTwo.cfm?collection_object_id="+a+"&transaction_id="+b;mywin=windowOpener(c,"myWin","height=300,width=800,resizable,location,menubar ,scrollbars ,status ,titlebar,toolbar")}function removeItems(){var a=document.getElementById("killRowList").value,b=document.getElementById("mapURL").value;document.location="SpecimenResults.cfm?"+b+"&exclCollObjId="+a}function toggleKillrow(a,b){var c=document.getElementById("killRowList");if(1==b){var d=[];c.value.length>0&&(d=c.value.split(",")),d.push(a);var e=d.join(",");c.value=e}else{var d=c.value.split(",");for(i=0;i<d.length;++i)d[i]==a&&d.splice(i,1);var e=d.toString();c.value=e}var f=document.getElementById("removeChecked");e.length>-1?f.style.display="block":f.style.display="none"}function getSpecResultsData(a,b,c,d){if(document.getElementById("resultsGoHere")){var e='<div id="loading" style="position:relative;top:0px;left:0px;z-index:999;color:white;background-color:green;';e+='font-size:large;font-weight:bold;padding:15px;">Fetching data...</div>';var f=document.getElementById("resultsGoHere");f.innerHTML=e}if(isNaN(a)&&a.indexOf(",")>0){var g=a.split(",");a=g[0],b=g[1]}if(null==c)if(document.getElementById("orderBy1")&&document.getElementById("orderBy1"))var h=document.getElementById("orderBy1").value,i=document.getElementById("orderBy2").value,c=h+","+i;else var c="cat_num";if(null==d)var d="ASC";if(c.indexOf(",")>-1){var j=c.split(",");c=j[1]==j[0]?j[0]+" "+d:j[0]+" "+d+","+j[1]+" "+d}else c+=" "+d;jQuery.getJSON("/component/functions.cfc",{method:"getSpecResultsData",startrow:a,numrecs:b,orderBy:c,returnformat:"json",queryformat:"column"},success_getSpecResultsData)}function success_getSpecResultsData(result){var data=result.DATA,attributes="Associated_MCZ_Collection,abnormality,age,age_class,associated_grant,associated_taxon,bare_parts_coloration,body_length,citation,colors,crown_rump_length,date_collected,date_emerged,diameter,disk_length,disk_width,ear_from_notch,extent,fat_deposition,forearm_length,fork_length,fossil_measurement,head_length,height,hind_foot_with_claw,host,incubation,length,life_cycle_stage,life_stage,max_display_angle,molt_condition,numeric_age,ossification,plumage_coloration,plumage_description,reference,reproductive_condition,reproductive_data,section_length,section_stain,sex,size_fish,snout_vent_length,specimen_length,stage_description,standard_length,stomach_contents,storage,tail_length,temperature_experiment,total_length,total_size,tragus_length,unformatted_measurements,unnamed_form,unspecified_measurement,verbatim_elevation,weight,width,wing_chord",attAry=attributes.split(","),nAtt=attAry.length,collection_object_id=data.COLLECTION_OBJECT_ID[0];if(collection_object_id<1){var msg=data.message[0];alert(msg)}else{var clist=data.COLUMNLIST[0],tgt=document.getElementById("resultsGoHere");if(document.getElementById("killrow")&&1==document.getElementById("killrow").value)var killrow=1;else var killrow=0;if(document.getElementById("action")&&document.getElementById("action").value.length>0)var action=document.getElementById("action").value;else var action="";if(document.getElementById("transaction_id")&&document.getElementById("transaction_id").value.length>0)var transaction_id=document.getElementById("transaction_id").value;else var transaction_id="";if(document.getElementById("loan_request_coll_id")&&document.getElementById("loan_request_coll_id").value.length>0)var loan_request_coll_id=document.getElementById("loan_request_coll_id").value;else var loan_request_coll_id="";if(document.getElementById("mapURL")&&document.getElementById("mapURL").value.length>0)var mapURL=document.getElementById("mapURL").value;else var mapURL="";var theInnerHtml='<table class="specResultTab"><tr>';for(1==killrow&&(theInnerHtml+="<th>Remove</th>"),theInnerHtml+="<th>Cat&nbsp;Num</th>",loan_request_coll_id.length>0&&(theInnerHtml+="<th>Request</th>"),"dispCollObj"==action&&(theInnerHtml+="<th>Loan</th>"),data.COLUMNLIST[0].indexOf("CUSTOMID")>-1&&(theInnerHtml+="<th>",theInnerHtml+=data.MYCUSTOMIDTYPE[0],theInnerHtml+="</th>"),data.COLUMNLIST[0].indexOf("MEDIA")>-1&&(theInnerHtml+="<th>Media</th>"),theInnerHtml+="<th>Identification</th>",data.COLUMNLIST[0].indexOf("ID_SENSU")>-1&&(theInnerHtml+="<th>ID sensu</th>"),data.COLUMNLIST[0].indexOf("STORED_AS")>-1&&(theInnerHtml+="<th>Stored As</th>"),data.COLUMNLIST[0].indexOf("SCI_NAME_WITH_AUTH")>-1&&(theInnerHtml+="<th>Scientific&nbsp;Name</th>"),data.COLUMNLIST[0].indexOf("CITED_AS")>-1&&(theInnerHtml+="<th>Cited&nbsp;As</th>"),data.COLUMNLIST[0].indexOf("CITATIONS")>-1&&(theInnerHtml+="<th>Citations</th>"),data.COLUMNLIST[0].indexOf("ID_HISTORY")>-1&&(theInnerHtml+="<th>Identification&nbsp;History</th>"),data.COLUMNLIST[0].indexOf("IDENTIFIED_BY")>-1&&(theInnerHtml+="<th>Identified&nbsp;By</th>"),data.COLUMNLIST[0].indexOf("PHYLCLASS")>-1&&(theInnerHtml+="<th>Class</th>"),data.COLUMNLIST[0].indexOf("PHYLORDER")>-1&&(theInnerHtml+="<th>Order</th>"),data.COLUMNLIST[0].indexOf("FAMILY")>-1&&(theInnerHtml+="<th>Family</th>"),data.COLUMNLIST[0].indexOf("OTHERCATALOGNUMBERS")>-1&&(theInnerHtml+="<th>Other&nbsp;Identifiers</th>"),data.COLUMNLIST[0].indexOf("ACCESSION")>-1&&(theInnerHtml+="<th>Accession</th>"),data.COLUMNLIST[0].indexOf("COLLECTORS")>-1&&(theInnerHtml+="<th>Collectors</th>"),data.COLUMNLIST[0].indexOf("PREPARATORS")>-1&&(theInnerHtml+="<th>Preparators</th>"),data.COLUMNLIST[0].indexOf("VERBATIMLATITUDE")>-1&&(theInnerHtml+="<th>Verbatim Latitude</th>"),data.COLUMNLIST[0].indexOf("VERBATIMLONGITUDE")>-1&&(theInnerHtml+="<th>Verbatim Longitude</th>"),data.COLUMNLIST[0].indexOf("COORDINATEUNCERTAINTYINMETERS")>-1&&(theInnerHtml+="<th>Max&nbsp;Error&nbsp;(m)</th>"),data.COLUMNLIST[0].indexOf("DATUM")>-1&&(theInnerHtml+="<th>Datum</th>"),data.COLUMNLIST[0].indexOf("ORIG_LAT_LONG_UNITS")>-1&&(theInnerHtml+="<th>Original&nbsp;Lat/Long&nbsp;Units</th>"),data.COLUMNLIST[0].indexOf("LAT_LONG_DETERMINER")>-1&&(theInnerHtml+="<th>Georeferenced&nbsp;By</th>"),data.COLUMNLIST[0].indexOf("LAT_LONG_REF_SOURCE")>-1&&(theInnerHtml+="<th>Lat/Long&nbsp;Reference</th>"),data.COLUMNLIST[0].indexOf("LAT_LONG_REMARKS")>-1&&(theInnerHtml+="<th>Lat/Long&nbsp;Remarks</th>"),data.COLUMNLIST[0].indexOf("CONTINENT_OCEAN")>-1&&(theInnerHtml+="<th>Continent</th>"),data.COLUMNLIST[0].indexOf("COUNTRY")>-1&&(theInnerHtml+="<th>Country</th>"),data.COLUMNLIST[0].indexOf("STATE_PROV")>-1&&(theInnerHtml+="<th>State</th>"),data.COLUMNLIST[0].indexOf("SEA")>-1&&(theInnerHtml+="<th>Sea</th>"),data.COLUMNLIST[0].indexOf("QUAD")>-1&&(theInnerHtml+="<th>Map&nbsp;Name</th>"),data.COLUMNLIST[0].indexOf("FEATURE")>-1&&(theInnerHtml+="<th>Land Feature</th>"),data.COLUMNLIST[0].indexOf("WATER_FEATURE")>-1&&(theInnerHtml+="<th>Water Feature</th>"),data.COLUMNLIST[0].indexOf("COUNTY")>-1&&(theInnerHtml+="<th>County</th>"),data.COLUMNLIST[0].indexOf("ISLAND_GROUP")>-1&&(theInnerHtml+="<th>Island&nbsp;Group</th>"),data.COLUMNLIST[0].indexOf("ISLAND")>-1&&(theInnerHtml+="<th>Island</th>"),data.COLUMNLIST[0].indexOf("ASSOCIATED_SPECIES")>-1&&(theInnerHtml+="<th>Associated&nbsp;Species</th>"),data.COLUMNLIST[0].indexOf("HABITAT")>-1&&(theInnerHtml+="<th>Microhabitat</th>"),data.COLUMNLIST[0].indexOf("MIN_ELEV_IN_M")>-1&&(theInnerHtml+="<th>Min&nbsp;Elevation&nbsp;(m)</th>"),data.COLUMNLIST[0].indexOf("MAX_ELEV_IN_M")>-1&&(theInnerHtml+="<th>Max&nbsp;Elevation&nbsp;(m)</th>"),data.COLUMNLIST[0].indexOf("MINIMUM_ELEVATION")>-1&&(theInnerHtml+="<th>Min&nbsp;Elevation</th>"),data.COLUMNLIST[0].indexOf("MAXIMUM_ELEVATION")>-1&&(theInnerHtml+="<th>Max&nbsp;Elevation</th>"),data.COLUMNLIST[0].indexOf("ORIG_ELEV_UNITS")>-1&&(theInnerHtml+="<th>Elevation&nbsp;Units</th>"),data.COLUMNLIST[0].indexOf("MIN_DEPTH_IN_M")>-1&&(theInnerHtml+="<th>Min&nbsp;Depth&nbsp;(m)</th>"),data.COLUMNLIST[0].indexOf("MAX_DEPTH_IN_M")>-1&&(theInnerHtml+="<th>Max&nbsp;Depth&nbsp;(m)</th>"),data.COLUMNLIST[0].indexOf("MIN_DEPTH")>-1&&(theInnerHtml+="<th>Minimum&nbsp;Depth</th>"),data.COLUMNLIST[0].indexOf("MAX_DEPTH")>-1&&(theInnerHtml+="<th>Maximum&nbsp;Depth</th>"),data.COLUMNLIST[0].indexOf("DEPTH_UNITS")>-1&&(theInnerHtml+="<th>Depth&nbsp;Units</th>"),data.COLUMNLIST[0].indexOf("SPEC_LOCALITY")>-1&&(theInnerHtml+="<th>Specific&nbsp;Locality</th>"),data.COLUMNLIST[0].indexOf("VERBATIMLOCALITY")>-1&&(theInnerHtml+="<th>Verbatim&nbsp;Locality</th>"),data.COLUMNLIST[0].indexOf("GEOLOGY_ATTRIBUTES")>-1&&(theInnerHtml+="<th>Geology&nbsp;Attributes</th>"),data.COLUMNLIST[0].indexOf("VERBATIM_DATE")>-1&&(theInnerHtml+="<th>Verbatim&nbsp;Date</th>"),data.COLUMNLIST[0].indexOf("BEGAN_DATE")>-1&&(theInnerHtml+="<th>Began&nbsp;Date</th>"),data.COLUMNLIST[0].indexOf("ENDED_DATE")>-1&&(theInnerHtml+="<th>Ended&nbsp;Date</th>"),data.COLUMNLIST[0].indexOf("COLLECTING_TIME")>-1&&(theInnerHtml+="<th>Collecting&nbsp;Time</th>"),data.COLUMNLIST[0].indexOf("COLLECTING_METHOD")>-1&&(theInnerHtml+="<th>Collecting&nbsp;Method</th>"),data.COLUMNLIST[0].indexOf("YEARCOLL")>-1&&(theInnerHtml+="<th>Year</th>"),data.COLUMNLIST[0].indexOf("MONCOLL")>-1&&(theInnerHtml+="<th>Month</th>"),data.COLUMNLIST[0].indexOf("DAYCOLL")>-1&&(theInnerHtml+="<th>Day</th>"),data.COLUMNLIST[0].indexOf("TOTAL_PARTS")>-1&&(theInnerHtml+="<th>TOTAL PARTS</th>"),data.COLUMNLIST[0].indexOf("PARTS")>-1&&(theInnerHtml+="<th>Parts</th>"),data.COLUMNLIST[0].indexOf("PARTDETAIL")>-1&&(theInnerHtml+="<th>Part Detail</th>"),data.COLUMNLIST[0].indexOf("SEX")>-1&&(theInnerHtml+="<th>Sex</th>"),data.COLUMNLIST[0].indexOf("REMARKS")>-1&&(theInnerHtml+="<th>Specimen&nbsp;Remarks</th>"),a=0;a<nAtt;a++)data.COLUMNLIST[0].indexOf(attAry[a].toUpperCase())>-1&&(theInnerHtml+="<th>"+attAry[a]+"</th>");data.COLUMNLIST[0].indexOf("DEC_LAT")>-1&&(theInnerHtml+="<th>Dec.&nbsp;Lat.</th>"),data.COLUMNLIST[0].indexOf("DEC_LONG")>-1&&(theInnerHtml+="<th>Dec.&nbsp;Long.</th>"),data.COLUMNLIST[0].indexOf("GREF_COLLNUM")>-1&&(theInnerHtml+="<th>Gref&nbsp;Link</th>"),theInnerHtml+="</tr>";var orderedCollObjIdArray=new Array;for(i=0;i<result.ROWCOUNT;++i)orderedCollObjIdArray.push(data.COLLECTION_OBJECT_ID[i]);var orderedCollObjIdList="";if(orderedCollObjIdArray.length<200)var orderedCollObjIdList=orderedCollObjIdArray.join(",");for(i=0;i<result.ROWCOUNT;++i){orderedCollObjIdArray.push(data.COLLECTION_OBJECT_ID[i]);var isType=!1,isPSType=!1,typestatus="",rowClass="";if(data.COLUMNLIST[0].indexOf("TYPESTATUS")>-1&&null!=data.TYPESTATUS[i]&&data.TYPESTATUS[i].length>0&&(isType=!0,typestatus=data.TYPESTATUS[i].replace("|","<BR>")),data.COLUMNLIST[0].indexOf("TOPTYPESTATUSKIND")>-1&&null!=data.TOPTYPESTATUSKIND[i]&&data.TOPTYPESTATUSKIND[i].length>0&&(typestatuskind=data.TOPTYPESTATUSKIND[i],typestatuskind.indexOf("Primary")>-1&&(isPSType=!0,rowClass="typeRow"),typestatuskind.indexOf("Secondary")>-1&&(isPSType=!0,rowClass="secTypeRow")),theInnerHtml+=isPSType?'<tr class="'+rowClass+'">':i%2?'<tr class="oddRow">':'<tr class="evenRow">',1==killrow&&(theInnerHtml+='<td align="center"><input type="checkbox" onchange="toggleKillrow(\'',theInnerHtml+=data.COLLECTION_OBJECT_ID[i]+"',this.checked);\"></td>"),theInnerHtml+='<td nowrap="nowrap" id="CatItem_'+data.COLLECTION_OBJECT_ID[i]+'">',theInnerHtml+='<a href="/SpecimenDetail.cfm?collection_object_id=',theInnerHtml+=data.COLLECTION_OBJECT_ID[i],theInnerHtml+='">',theInnerHtml+=data.COLLECTION[i],theInnerHtml+="&nbsp;",theInnerHtml+=data.CAT_NUM[i],theInnerHtml+="</a>",isType&&(theInnerHtml+='<div class="showType">'+typestatus+"</div>"),theInnerHtml+="</td>",loan_request_coll_id.length>0&&(loan_request_coll_id==data.COLLECTION_ID[i]?(theInnerHtml+='<td><span class="likeLink" onclick="addLoanItem(\'',theInnerHtml+=data.COLLECTION_OBJECT_ID,theInnerHtml+="');\">Request</span></td>"):theInnerHtml+="<td>N/A</td>"),"dispCollObj"==action&&(theInnerHtml+='<td id="partCell_'+data.COLLECTION_OBJECT_ID[i]+'"></td>'),data.COLUMNLIST[0].indexOf("CUSTOMID")>-1&&(theInnerHtml+="<td>"+data.CUSTOMID[i]+"</td>"),data.COLUMNLIST[0].indexOf("MEDIA")>-1){theInnerHtml+="<td>",theInnerHtml+='<div class="shortThumb"><div class="thumb_spcr">&nbsp;</div>';var thisMedia=JSON.parse(data.MEDIA[i]);for(m=0;m<thisMedia.ROWCOUNT;++m)thisMedia.DATA.preview_uri[m].length>0?pURI=thisMedia.DATA.preview_uri[m]:"audio"==thisMedia.DATA.mimecat[m]?pURI="images/audioNoThumb.png":pURI="/images/noThumb.jpg",theInnerHtml+='<div class="one_thumb">',theInnerHtml+='<a href="'+thisMedia.DATA.media_uri[m]+'" target="_blank">',theInnerHtml+='<img src="'+pURI+'" class="theThumb"></a>',theInnerHtml+="<p>"+thisMedia.DATA.mimecat[m]+" ("+thisMedia.DATA.mime_type[m]+")",theInnerHtml+='<br><a target="_blank" href="/media/'+thisMedia.DATA.media_id[m]+'">Media Detail</a></p></div>';theInnerHtml+='<div class="thumb_spcr">&nbsp;</div></div>',theInnerHtml+="</td>"}for(theInnerHtml+="<td>",theInnerHtml+='<span class="browseLink" type="scientific_name" dval="'+encodeURI(data.SCIENTIFIC_NAME[i])+'">'+spaceStripper(data.SCIENTIFIC_NAME[i]),theInnerHtml+="</span>",theInnerHtml+="</td>",data.COLUMNLIST[0].indexOf("ID_SENSU")>-1&&(theInnerHtml+="<td>",theInnerHtml+=data.ID_SENSU[i],theInnerHtml+="</td>"),data.COLUMNLIST[0].indexOf("STORED_AS")>-1&&(theInnerHtml+="<td>",theInnerHtml+=data.STORED_AS[i],theInnerHtml+="</td>"),data.COLUMNLIST[0].indexOf("SCI_NAME_WITH_AUTH")>-1&&(theInnerHtml+="<td>",theInnerHtml+=spaceStripper(data.SCI_NAME_WITH_AUTH[i]),theInnerHtml+="</td>"),data.COLUMNLIST[0].indexOf("CITED_AS")>-1&&(theInnerHtml+="<td>",theInnerHtml+=spaceStripper(data.CITED_AS[i]),theInnerHtml+="</td>"),data.COLUMNLIST[0].indexOf("CITATIONS")>-1&&(theInnerHtml+="<td>",theInnerHtml+=spaceStripper(data.CITATIONS[i]),theInnerHtml+="</td>"),data.COLUMNLIST[0].indexOf("ID_HISTORY")>-1&&(theInnerHtml+="<td>",theInnerHtml+=data.ID_HISTORY[i],theInnerHtml+="</td>"),data.COLUMNLIST[0].indexOf("IDENTIFIED_BY")>-1&&(theInnerHtml+="<td>"+splitBySemicolon(data.IDENTIFIED_BY[i])+"</td>"),data.COLUMNLIST[0].indexOf("PHYLCLASS")>-1&&(theInnerHtml+="<td>"+data.PHYLCLASS[i]+"</td>"),data.COLUMNLIST[0].indexOf("PHYLORDER")>-1&&(theInnerHtml+="<td>"+data.PHYLORDER[i]+"</td>"),data.COLUMNLIST[0].indexOf("FAMILY")>-1&&(theInnerHtml+="<td>"+data.FAMILY[i]+"</td>"),data.COLUMNLIST[0].indexOf("OTHERCATALOGNUMBERS")>-1&&(theInnerHtml+="<td>"+splitBySemicolon(data.OTHERCATALOGNUMBERS[i])+"</td>"),data.COLUMNLIST[0].indexOf("ACCESSION")>-1&&(theInnerHtml+="<td>"+spaceStripper(data.ACCESSION[i])+"</td>"),data.COLUMNLIST[0].indexOf("COLLECTORS")>-1&&(theInnerHtml+="<td>"+splitByComma(data.COLLECTORS[i])+"</td>"),data.COLUMNLIST[0].indexOf("PREPARATORS")>-1&&(theInnerHtml+="<td>"+splitByComma(data.PREPARATORS[i])+"</td>"),data.COLUMNLIST[0].indexOf("VERBATIMLATITUDE")>-1&&(theInnerHtml+="<td>"+cordFormat(data.VERBATIMLATITUDE[i])+"</td>"),data.COLUMNLIST[0].indexOf("VERBATIMLONGITUDE")>-1&&(theInnerHtml+="<td>"+cordFormat(data.VERBATIMLONGITUDE[i])+"</td>"),data.COLUMNLIST[0].indexOf("COORDINATEUNCERTAINTYINMETERS")>-1&&(theInnerHtml+="<td>"+data.COORDINATEUNCERTAINTYINMETERS[i]+"</td>"),data.COLUMNLIST[0].indexOf("DATUM")>-1&&(theInnerHtml+="<td>"+spaceStripper(data.DATUM[i])+"</td>"),data.COLUMNLIST[0].indexOf("ORIG_LAT_LONG_UNITS")>-1&&(theInnerHtml+="<td>"+data.ORIG_LAT_LONG_UNITS[i]+"</td>"),data.COLUMNLIST[0].indexOf("LAT_LONG_DETERMINER")>-1&&(theInnerHtml+="<td>"+splitBySemicolon(data.LAT_LONG_DETERMINER[i])+"</td>"),data.COLUMNLIST[0].indexOf("LAT_LONG_REF_SOURCE")>-1&&(theInnerHtml+="<td>"+data.LAT_LONG_REF_SOURCE[i]+"</td>"),data.COLUMNLIST[0].indexOf("LAT_LONG_REMARKS")>-1&&(theInnerHtml+='<td><div class="wrapLong">'+data.LAT_LONG_REMARKS[i]+"</div></td>"),data.COLUMNLIST[0].indexOf("CONTINENT_OCEAN")>-1&&(theInnerHtml+="<td>"+spaceStripper(data.CONTINENT_OCEAN[i])+"</td>"),data.COLUMNLIST[0].indexOf("COUNTRY")>-1&&(theInnerHtml+="<td>"+spaceStripper(data.COUNTRY[i])+"</td>"),data.COLUMNLIST[0].indexOf("STATE_PROV")>-1&&(theInnerHtml+="<td>"+spaceStripper(data.STATE_PROV[i])+"</td>"),data.COLUMNLIST[0].indexOf("SEA")>-1&&(theInnerHtml+="<td>"+data.SEA[i]+"</td>"),data.COLUMNLIST[0].indexOf("QUAD")>-1&&(theInnerHtml+="<td>"+spaceStripper(data.QUAD[i])+"</td>"),data.COLUMNLIST[0].indexOf("FEATURE")>-1&&(theInnerHtml+="<td>"+spaceStripper(data.FEATURE[i])+"</td>"),data.COLUMNLIST[0].indexOf("WATER_FEATURE")>-1&&(theInnerHtml+="<td>"+spaceStripper(data.WATER_FEATURE[i])+"</td>"),data.COLUMNLIST[0].indexOf("COUNTY")>-1&&(theInnerHtml+="<td>"+data.COUNTY[i]+"</td>"),data.COLUMNLIST[0].indexOf("ISLAND_GROUP")>-1&&(theInnerHtml+="<td>"+spaceStripper(data.ISLAND_GROUP[i])+"</td>"),data.COLUMNLIST[0].indexOf("ISLAND")>-1&&(theInnerHtml+="<td>"+spaceStripper(data.ISLAND[i])+"</td>"),data.COLUMNLIST[0].indexOf("ASSOCIATED_SPECIES")>-1&&(theInnerHtml+='<td><div class="wrapLong">'+data.ASSOCIATED_SPECIES[i]+"</div></td>"),data.COLUMNLIST[0].indexOf("HABITAT")>-1&&(theInnerHtml+='<td><div class="wrapLong">'+data.HABITAT[i]+"</div></td>"),data.COLUMNLIST[0].indexOf("MIN_ELEV_IN_M")>-1&&(theInnerHtml+="<td>"+data.MIN_ELEV_IN_M[i]+"</td>"),data.COLUMNLIST[0].indexOf("MAX_ELEV_IN_M")>-1&&(theInnerHtml+="<td>"+data.MAX_ELEV_IN_M[i]+"</td>"),data.COLUMNLIST[0].indexOf("MINIMUM_ELEVATION")>-1&&(theInnerHtml+="<td>"+data.MINIMUM_ELEVATION[i]+"</td>"),data.COLUMNLIST[0].indexOf("MAXIMUM_ELEVATION")>-1&&(theInnerHtml+="<td>"+data.MAXIMUM_ELEVATION[i]+"</td>"),data.COLUMNLIST[0].indexOf("ORIG_ELEV_UNITS")>-1&&(theInnerHtml+="<td>"+data.ORIG_ELEV_UNITS[i]+"</td>"),data.COLUMNLIST[0].indexOf("MIN_DEPTH_IN_M")>-1&&(theInnerHtml+="<td>"+data.MIN_DEPTH_IN_M[i]+"</td>"),data.COLUMNLIST[0].indexOf("MAX_DEPTH_IN_M")>-1&&(theInnerHtml+="<td>"+data.MAX_DEPTH_IN_M[i]+"</td>"),data.COLUMNLIST[0].indexOf("MIN_DEPTH")>-1&&(theInnerHtml+="<td>"+data.MIN_DEPTH[i]+"</td>"),data.COLUMNLIST[0].indexOf("MAX_DEPTH")>-1&&(theInnerHtml+="<td>"+data.MAX_DEPTH[i]+"</td>"),data.COLUMNLIST[0].indexOf("DEPTH_UNITS")>-1&&(theInnerHtml+="<td>"+data.DEPTH_UNITS[i]+"</td>"),data.COLUMNLIST[0].indexOf("SPEC_LOCALITY")>-1&&(theInnerHtml+='<td id="SpecLocality_'+data.COLLECTION_OBJECT_ID[i]+'">',theInnerHtml+='<span class="browseLink" type="spec_locality" dval="'+encodeURI(data.SPEC_LOCALITY[i])+'"><div class="wrapLong">'+data.SPEC_LOCALITY[i]+"</div>",theInnerHtml+="</span>",theInnerHtml+="</td>"),data.COLUMNLIST[0].indexOf("VERBATIMLOCALITY")>-1&&(theInnerHtml+="<td>"+data.VERBATIMLOCALITY[i]+"</td>"),data.COLUMNLIST[0].indexOf("GEOLOGY_ATTRIBUTES")>-1&&(theInnerHtml+="<td>"+data.GEOLOGY_ATTRIBUTES[i]+"</td>"),data.COLUMNLIST[0].indexOf("VERBATIM_DATE")>-1&&(theInnerHtml+="<td>"+data.VERBATIM_DATE[i]+"</td>"),data.COLUMNLIST[0].indexOf("BEGAN_DATE")>-1&&(theInnerHtml+="<td>"+data.BEGAN_DATE[i]+"</td>"),data.COLUMNLIST[0].indexOf("ENDED_DATE")>-1&&(theInnerHtml+="<td>"+data.ENDED_DATE[i]+"</td>"),data.COLUMNLIST[0].indexOf("COLLECTING_TIME")>-1&&(theInnerHtml+="<td>"+data.COLLECTING_TIME[i]+"</td>"),data.COLUMNLIST[0].indexOf("COLLECTING_METHOD")>-1&&(theInnerHtml+="<td>"+data.COLLECTING_METHOD[i]+"</td>"),data.COLUMNLIST[0].indexOf("YEARCOLL")>-1&&(theInnerHtml+="<td>"+data.YEARCOLL[i]+"</td>"),data.COLUMNLIST[0].indexOf("MONCOLL")>-1&&(theInnerHtml+="<td>"+data.MONCOLL[i]+"</td>"),data.COLUMNLIST[0].indexOf("DAYCOLL")>-1&&(theInnerHtml+="<td>"+data.DAYCOLL[i]+"</td>"),data.COLUMNLIST[0].indexOf("TOTAL_PARTS")>-1&&(theInnerHtml+="<td>"+data.TOTAL_PARTS[i]+"</td>"),data.COLUMNLIST[0].indexOf("PARTS")>-1&&(theInnerHtml+='<td><div class="wrapLong">'+splitBySemicolon(data.PARTS[i])+"</div></td>"),data.COLUMNLIST[0].indexOf("PARTDETAIL")>-1&&(theInnerHtml+='<td><div class="wrapLong">'+splitByLF(data.PARTDETAIL[i])+"</div></td>"),data.COLUMNLIST[0].indexOf("SEX")>-1&&(theInnerHtml+="<td>"+data.SEX[i]+"</td>"),data.COLUMNLIST[0].indexOf("REMARKS")>-1&&(theInnerHtml+="<td>"+data.REMARKS[i]+"</td>"),a=0;a<nAtt;a++)if(data.COLUMNLIST[0].indexOf(attAry[a].toUpperCase())>-1){var attStr="data."+attAry[a].toUpperCase()+"["+i+"]";theInnerHtml+="<td>"+eval(attStr)+"</td>"}data.COLUMNLIST[0].indexOf("DEC_LAT")>-1&&(theInnerHtml+='<td style="font-size:small">'+data.DEC_LAT[i]+"</td>"),data.COLUMNLIST[0].indexOf("DEC_LONG")>-1&&(theInnerHtml+='<td style="font-size:small">'+data.DEC_LONG[i]+"</td>"),theInnerHtml+="</tr>"}theInnerHtml+="</table>",theInnerHtml=theInnerHtml.replace(/<td>null<\/td>/g,"<td>&nbsp;</td>"),theInnerHtml=theInnerHtml.replace(/<div class="wrapLong">null<\/div>/g,"&nbsp;"),theInnerHtml=theInnerHtml.replace(/<td style="font-size:small">null<\/td>/g,"<td>&nbsp;</td>"),tgt.innerHTML=theInnerHtml,"dispCollObj"==action&&makePartThingy(),insertMedia(orderedCollObjIdList)}}function ssvar(a,b){alert(a+" "+b);var c=document.getElementById("s_startrow"),d=document.getElementById("s_torow");c.innerHTML=a,d.innerHTML=parseInt(a)+parseInt(b)-1,jQuery.getJSON("/component/functions.cfc",{method:"ssvar",startrow:a,maxrows:b,returnformat:"json",queryformat:"column"},success_ssvar)}function jumpToPage(a){var b=a.split(","),c=b[0],d=b[1];ssvar(c,d)}function closeCustom(){var a=document.getElementById("customDiv");document.body.removeChild(a);var b="/SpecimenResults.cfm?"+document.getElementById("mapURL").value;window.location=b}function closeCustomNoRefresh(){var a=document.getElementById("customDiv");document.body.removeChild(a);var a=document.getElementById("bgDiv");document.body.removeChild(a)}function logIt(a,b){var c=document.getElementById("msgs"),d=document.getElementById("msgs_hist"),e=c.innerHTML+"<hr>"+d.innerHTML;d.innerHTML=e,c.innerHTML=a,0==b?c.className="error":(c.className="successDiv",document.getElementById("oidnum").focus(),document.getElementById("oidnum").select())}
